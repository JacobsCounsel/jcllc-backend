<!-- JACOBS COUNSEL â€” AI-Enhanced Business Formation Intake -->
<style>
:root {
  --jc-orange: #ff4d00;
  --jc-ink: #0f172a;
  --success: #10b981;
  --warning: #f59e0b;
  --danger: #ef4444;
  --startup-blue: #3b82f6;
  --venture-purple: #8b5cf6;
  --growth-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --card-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  --glow: 0 0 20px rgba(255, 77, 0, 0.3);
  --startup-glow: 0 0 30px rgba(59, 130, 246, 0.4);
}

.jc-business-intake {
  min-height: 100vh;
  background: var(--growth-gradient);
  padding: 40px 20px;
  font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
  position: relative;
  overflow: hidden;
}

.jc-business-intake::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="growth-grid" width="12" height="12" patternUnits="userSpaceOnUse"><path d="M 12 0 L 0 0 0 12" fill="none" stroke="rgba(59,130,246,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23growth-grid)"/></svg>');
  pointer-events: none;
}

/* Startup Header */
.business-header {
  text-align: center;
  margin-bottom: 40px;
  position: relative;
  z-index: 1;
}

.startup-badge {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  background: rgba(59, 130, 246, 0.2);
  backdrop-filter: blur(10px);
  padding: 10px 24px;
  border-radius: 50px;
  color: var(--startup-blue);
  font-weight: 700;
  font-size: 0.9rem;
  margin-bottom: 20px;
  border: 1px solid rgba(59, 130, 246, 0.3);
  box-shadow: var(--startup-glow);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.business-title {
  font-size: clamp(2.5rem, 5vw, 4rem);
  font-weight: 800;
  color: white;
  margin: 0 0 16px;
  line-height: 1.1;
  text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
}

.business-subtitle {
  font-size: 1.4rem;
  color: rgba(255, 255, 255, 0.9);
  max-width: 700px;
  margin: 0 auto;
  line-height: 1.6;
}

/* Smart Business Analyzer */
.business-analyzer {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(20px);
  border-radius: 24px;
  padding: 40px;
  margin: 0 auto 40px;
  max-width: 900px;
  box-shadow: var(--card-shadow);
  border: 1px solid rgba(59, 130, 246, 0.2);
  position: relative;
  z-index: 1;
}

.analyzer-header {
  text-align: center;
  margin-bottom: 30px;
}

.analyzer-title {
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--jc-ink);
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
}

.venture-indicator {
  background: linear-gradient(135deg, var(--startup-blue), var(--venture-purple));
  color: white;
  padding: 6px 12px;
  border-radius: 16px;
  font-size: 0.8rem;
  font-weight: 600;
  animation: pulse 2s infinite;
}

/* Business Model Canvas */
.business-canvas {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 20px;
  margin-bottom: 30px;
}

.canvas-section {
  background: #f8fafc;
  border-radius: 12px;
  padding: 20px;
  border: 2px solid #e2e8f0;
  transition: all 0.3s ease;
}

.canvas-section.active {
  border-color: var(--startup-blue);
  background: rgba(59, 130, 246, 0.05);
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(59, 130, 246, 0.15);
}

.canvas-title {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--jc-ink);
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.canvas-input {
  width: 100%;
  padding: 12px 16px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  font-size: 0.95rem;
  resize: vertical;
  min-height: 80px;
  transition: all 0.3s ease;
}

.canvas-input:focus {
  border-color: var(--startup-blue);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  outline: none;
}

/* AI Insights Panel */
.ai-insights {
  background: linear-gradient(135deg, var(--jc-ink), #1e293b);
  color: white;
  border-radius: 16px;
  padding: 24px;
  margin: 30px 0;
  position: relative;
  overflow: hidden;
}

.ai-insights::before {
  content: 'ðŸš€';
  position: absolute;
  top: -10px;
  right: -10px;
  font-size: 4rem;
  opacity: 0.2;
}

.insights-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 20px;
}

.insights-title {
  font-size: 1.3rem;
  font-weight: 700;
}

.funding-tracker {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-bottom: 20px;
}

.funding-metric {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border-radius: 12px;
  padding: 16px;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.metric-label {
  font-size: 0.85rem;
  opacity: 0.8;
  margin-bottom: 4px;
}

.metric-value {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--startup-blue);
}

/* Smart Recommendations */
.smart-recs {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border-radius: 12px;
  padding: 20px;
  margin-top: 20px;
}

.rec-grid {
  display: grid;
  gap: 12px;
}

.rec-item {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  padding: 16px;
  border-left: 3px solid var(--startup-blue);
}

.rec-priority {
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 6px;
  color: var(--startup-blue);
}

.rec-title {
  font-size: 1rem;
  font-weight: 600;
  margin-bottom: 6px;
}

.rec-desc {
  font-size: 0.9rem;
  opacity: 0.9;
  line-height: 1.4;
}

/* Entity Selection Matrix */
.entity-matrix {
  background: white;
  border-radius: 20px;
  padding: 30px;
  margin: 30px 0;
  box-shadow: var(--card-shadow);
}

.matrix-header {
  text-align: center;
  margin-bottom: 30px;
}

.matrix-title {
  font-size: 1.6rem;
  font-weight: 700;
  color: var(--jc-ink);
  margin-bottom: 12px;
}

.matrix-subtitle {
  color: #64748b;
  font-size: 1rem;
}

.entity-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.entity-card {
  background: #f8fafc;
  border: 2px solid #e2e8f0;
  border-radius: 16px;
  padding: 24px;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
}

.entity-card:hover {
  border-color: var(--startup-blue);
  transform: translateY(-4px);
  box-shadow: 0 12px 30px rgba(59, 130, 246, 0.15);
}

.entity-card.recommended {
  border-color: var(--jc-orange);
  background: rgba(255, 77, 0, 0.05);
  box-shadow: var(--glow);
}

.entity-card.recommended::after {
  content: 'AI RECOMMENDED';
  position: absolute;
  top: -8px;
  right: 16px;
  background: var(--jc-orange);
  color: white;
  padding: 4px 12px;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 700;
}

.entity-name {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--jc-ink);
  margin-bottom: 8px;
}

.entity-best-for {
  font-size: 0.85rem;
  color: var(--startup-blue);
  font-weight: 600;
  margin-bottom: 12px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.entity-desc {
  color: #64748b;
  font-size: 0.95rem;
  line-height: 1.4;
  margin-bottom: 16px;
}

.entity-features {
  list-style: none;
  padding: 0;
  margin: 0;
}

.entity-features li {
  font-size: 0.9rem;
  padding: 4px 0;
  color: #4b5563;
  position: relative;
  padding-left: 20px;
}

.entity-features li::before {
  content: 'âœ“';
  position: absolute;
  left: 0;
  color: var(--success);
  font-weight: bold;
}

/* Premium Form */
.business-form {
  background: white;
  border-radius: 24px;
  padding: 40px;
  margin: 40px auto 0;
  max-width: 800px;
  box-shadow: var(--card-shadow);
  position: relative;
  z-index: 1;
}

.form-section {
  margin-bottom: 40px;
}

.section-title {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--jc-ink);
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 2px solid var(--startup-blue);
}

.form-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
}

.form-input {
  width: 100%;
  padding: 14px 16px;
  border: 2px solid #e2e8f0;
  border-radius: 10px;
  font-size: 1rem;
  transition: all 0.3s ease;
}

.form-input:focus {
  border-color: var(--startup-blue);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
  outline: none;
}

.form-select {
  appearance: none;
  background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
  background-repeat: no-repeat;
  background-position: right 12px center;
  background-size: 16px;
  padding-right: 40px;
}

.textarea-input {
  min-height: 120px;
  resize: vertical;
  grid-column: 1 / -1;
}

/* Submit Button */
.submit-section {
  text-align: center;
  padding-top: 30px;
  border-top: 1px solid #e2e8f0;
}

.submit-button {
  background: linear-gradient(135deg, var(--startup-blue), var(--venture-purple));
  color: white;
  padding: 18px 48px;
  border: none;
  border-radius: 16px;
  font-size: 1.3rem;
  font-weight: 700;
  cursor: pointer;
  box-shadow: var(--startup-glow);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.submit-button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
  transition: left 0.4s ease;
}

.submit-button:hover {
  transform: translateY(-3px);
  box-shadow: 0 12px 30px rgba(59, 130, 246, 0.4);
}

.submit-button:hover::before {
  left: 100%;
}

.submit-disclaimer {
  margin-top: 20px;
  font-size: 0.9rem;
  color: #64748b;
  line-height: 1.5;
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .jc-business-intake {
    padding: 20px 15px;
  }
  
  .business-analyzer,
  .business-form {
    padding: 25px 20px;
    border-radius: 16px;
  }
  
  .business-title {
    font-size: 2.5rem;
  }
  
  .business-canvas {
    grid-template-columns: 1fr;
  }
  
  .entity-grid {
    grid-template-columns: 1fr;
  }
  
  .funding-tracker {
    grid-template-columns: 1fr;
  }
  
  .form-grid {
    grid-template-columns: 1fr;
  }
}
</style>

<div class="jc-business-intake" id="businessIntake">
  <!-- Startup Header -->
  <div class="business-header">
    <div class="startup-badge">
      <span>ðŸš€</span>
      <span>Startup-Optimized Formation</span>
    </div>
    <h1 class="business-title">Smart Business Formation</h1>
    <p class="business-subtitle">The wrong business structure can cost you thousands in taxes and leave you personally liable. AI-enhanced analysis identifies the optimal structure for your specific situation</p>
  </div>

  <!-- Smart Business Analyzer -->
  <div class="business-analyzer">
    <div class="analyzer-header">
      <h2 class="analyzer-title">
        <span>Business Intelligence Scanner</span>
        <span class="venture-indicator">AI-Powered</span>
      </h2>
      <p class="calculator-subtitle">Answer a few questions to get personalized entity recommendations and funding insights</p>
    </div>

    <!-- Business Model Canvas -->
    <div class="business-canvas">
      <div class="canvas-section" onclick="activateSection(this)">
        <h3 class="canvas-title">
          <span>ðŸ’¡</span>
          <span>Business Concept</span>
        </h3>
        <textarea class="canvas-input" placeholder="Describe your business idea in 2-3 sentences..." oninput="analyzeInput(this)"></textarea>
      </div>
      
      <div class="canvas-section" onclick="activateSection(this)">
        <h3 class="canvas-title">
          <span>ðŸŽ¯</span>
          <span>Target Market</span>
        </h3>
        <textarea class="canvas-input" placeholder="Who are your customers? What problem do you solve?" oninput="analyzeInput(this)"></textarea>
      </div>
      
      <div class="canvas-section" onclick="activateSection(this)">
        <h3 class="canvas-title">
          <span>ðŸ’°</span>
          <span>Revenue Model</span>
        </h3>
        <textarea class="canvas-input" placeholder="How will you make money? Subscription, one-time, commission?" oninput="analyzeInput(this)"></textarea>
      </div>
    </div>

    <!-- AI Insights Panel -->
    <div class="ai-insights" id="aiInsights" style="display: none;">
      <div class="insights-header">
        <span>ðŸ§ </span>
        <h3 class="insights-title">AI Business Analysis</h3>
      </div>

      <div class="funding-tracker">
        <div class="funding-metric">
          <div class="metric-label">Funding Potential</div>
          <div class="metric-value" id="fundingPotential">Analyzing...</div>
        </div>
        <div class="funding-metric">
          <div class="metric-label">Growth Stage</div>
          <div class="metric-value" id="growthStage">Analyzing...</div>
        </div>
        <div class="funding-metric">
          <div class="metric-label">Recommended Entity</div>
          <div class="metric-value" id="recommendedEntity">Analyzing...</div>
        </div>
      </div>

      <div class="smart-recs">
        <h4 style="margin: 0 0 16px; font-weight: 700;">AI-Generated Recommendations</h4>
        <div class="rec-grid" id="recommendationsList">
          <!-- Recommendations populated by JS -->
        </div>
      </div>
    </div>
  </div>

  <!-- Entity Selection Matrix -->
  <div class="entity-matrix">
    <div class="matrix-header">
      <h2 class="matrix-title">Choose Your Business Structure</h2>
      <p class="matrix-subtitle">Select the entity type that best fits your business goals and funding plans</p>
    </div>

    <div class="entity-grid">
      <div class="entity-card" onclick="selectEntity('LLC')" data-entity="LLC">
        <h3 class="entity-name">LLC</h3>
        <div class="entity-best-for">Best for: Most Businesses</div>
        <p class="entity-desc">Limited Liability Company - Perfect balance of protection and flexibility</p>
        <ul class="entity-features">
          <li>Personal asset protection</li>
          <li>Tax flexibility (pass-through or corp)</li>
          <li>Simple management structure</li>
          <li>Investor-friendly with proper planning</li>
        </ul>
      </div>

      <div class="entity-card" onclick="selectEntity('C-Corp')" data-entity="C-Corp">
        <h3 class="entity-name">C-Corporation</h3>
        <div class="entity-best-for">Best for: VC-Funded Startups</div>
        <p class="entity-desc">Traditional corporation structure preferred by venture capitalists</p>
        <ul class="entity-features">
          <li>Unlimited investor capacity</li>
          <li>Stock options for employees</li>
          <li>Preferred by VCs and angels</li>
          <li>Double taxation (but tax benefits available)</li>
        </ul>
      </div>

      <div class="entity-card" onclick="selectEntity('S-Corp')" data-entity="S-Corp">
        <h3 class="entity-name">S-Corporation</h3>
        <div class="entity-best-for">Best for: Profitable Service Businesses</div>
        <p class="entity-desc">Pass-through taxation with corporate benefits - great for established businesses</p>
        <ul class="entity-features">
          <li>No double taxation</li>
          <li>Self-employment tax savings</li>
          <li>Limited to 100 shareholders</li>
          <li>Restrictions on investor types</li>
        </ul>
      </div>

      <div class="entity-card" onclick="selectEntity('Delaware-C')" data-entity="Delaware-C">
        <h3 class="entity-name">Delaware C-Corp</h3>
        <div class="entity-best-for">Best for: High-Growth Tech Startups</div>
        <p class="entity-desc">The gold standard for venture-backed technology companies</p>
        <ul class="entity-features">
          <li>Preferred by 90% of VCs</li>
          <li>Superior corporate law</li>
          <li>Business-friendly court system</li>
          <li>Complex equity structures supported</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Premium Form -->
  <div class="business-form">
    <form id="businessFormationForm" onsubmit="submitBusinessFormation(event)">
      <!-- Business Information -->
      <div class="form-section">
        <h3 class="section-title">Business Information</h3>
        <div class="form-grid">
          <input type="text" name="businessName" class="form-input" placeholder="Proposed Business Name" required>
          <select name="industry" class="form-input form-select" required onchange="updateRecommendations()">
            <option value="">Select Industry</option>
            <option value="technology">Technology / Software</option>
            <option value="ecommerce">E-commerce / Retail</option>
            <option value="healthcare">Healthcare / Medical</option>
            <option value="fintech">FinTech / Financial Services</option>
            <option value="consulting">Professional Services / Consulting</option>
            <option value="manufacturing">Manufacturing / Product</option>
            <option value="realestate">Real Estate</option>
            <option value="foodservice">Food & Beverage</option>
            <option value="other">Other</option>
          </select>
          <select name="businessStage" class="form-input form-select" required onchange="updateRecommendations()">
            <option value="">Business Stage</option>
            <option value="idea">Idea Stage (No MVP)</option>
            <option value="mvp">MVP / Prototype</option>
            <option value="prerevenue">Pre-Revenue</option>
            <option value="earlyrevenue">Early Revenue (<$100K)</option>
            <option value="growing">Growing Business ($100K+)</option>
            <option value="established">Established Business ($1M+)</option>
          </select>
          <select name="projectedRevenue" class="form-input form-select">
            <option value="">Projected Year 1 Revenue</option>
            <option value="under100k">Under $100K</option>
            <option value="100k-500k">$100K - $500K</option>
            <option value="500k-1m">$500K - $1M</option>
            <option value="1m-5m">$1M - $5M</option>
            <option value="5m-25m">$5M - $25M</option>
            <option value="over25m">Over $25M</option>
          </select>
        </div>
      </div>

      <!-- Funding & Growth Plans -->
      <div class="form-section">
        <h3 class="section-title">Funding & Growth Strategy</h3>
        <div class="form-grid">
          <select name="fundingPlans" class="form-input form-select" onchange="updateRecommendations()">
            <option value="">Funding Plans</option>
            <option value="bootstrap">Bootstrap (Self-Funded)</option>
            <option value="friends_family">Friends & Family</option>
            <option value="angel">Angel Investors</option>
            <option value="vc">Venture Capital</option>
            <option value="bank_loan">Bank Loans / SBA</option>
            <option value="crowdfunding">Crowdfunding</option>
            <option value="revenue_based">Revenue-Based Financing</option>
            <option value="multiple">Multiple Sources</option>
          </select>
          <select name="employeePlans" class="form-input form-select">
            <option value="">Employee Plans</option>
            <option value="solo">Just Me (Solo)</option>
            <option value="small_team">Small Team (2-5)</option>
            <option value="medium_team">Medium Team (6-20)</option>
            <option value="large_team">Large Team (20+)</option>
            <option value="equity_compensation">Need Equity Compensation</option>
          </select>
          <select name="geographicScope" class="form-input form-select">
            <option value="">Geographic Scope</option>
            <option value="local">Local / Regional</option>
            <option value="national">National (US)</option>
            <option value="international">International</option>
            <option value="remote_first">Remote-First</option>
          </select>
          <select name="timeline" class="form-input form-select">
            <option value="">Formation Timeline</option>
            <option value="immediate">Immediate (This Week)</option>
            <option value="soon">Within 2 Weeks</option>
            <option value="month">Within a Month</option>
            <option value="planning">Planning Phase</option>
          </select>
        </div>
      </div>

      <!-- Personal Information -->
      <div class="form-section">
        <h3 class="section-title">Contact Information</h3>
        <div class="form-grid">
          <input type="text" name="firstName" class="form-input" placeholder="First Name" required>
          <input type="text" name="lastName" class="form-input" placeholder="Last Name" required>
          <input type="email" name="email" class="form-input" placeholder="Email Address" required>
          <input type="tel" name="phone" class="form-input" placeholder="Phone Number" required>
          <select name="state" class="form-input form-select" required>
            <option value="">Preferred State of Formation</option>
            <option value="DE">Delaware (Recommended for VCs)</option>
            <option value="NY">New York</option>
            <option value="NJ">New Jersey</option>
            <option value="OH">Ohio</option>
            <option value="CA">California</option>
            <option value="TX">Texas</option>
            <option value="other">Other</option>
          </select>
          <select name="packagePreference" class="form-input form-select">
            <option value="">Package Preference</option>
            <option value="basic">Basic Formation</option>
            <option value="standard">Standard Package</option>
            <option value="premium">Premium (Inc. Contracts)</option>
            <option value="venture">Venture-Ready Package</option>
            <option value="consultation">Consultation First</option>
          </select>
        </div>
      </div>

      <!-- Special Considerations -->
      <div class="form-section">
        <h3 class="section-title">Additional Information</h3>
        <textarea name="specialConsiderations" class="form-input textarea-input" placeholder="Any special considerations, partnership structures, intellectual property, or specific business requirements?"></textarea>
      </div>

      <!-- Hidden fields for backend integration -->
      <input type="hidden" name="submissionType" value="business-formation">
      <input type="hidden" name="source" value="business-formation-enhanced">
      <input type="hidden" name="recommendedEntity" id="recommendedEntityHidden">
      <input type="hidden" name="aiAnalysis" id="aiAnalysisHidden">
      <input type="hidden" name="assessmentScore" id="assessmentScoreHidden">

      <div class="submit-section">
        <button type="submit" class="submit-button">
Get My Strategic Entity Recommendation
        </button>
        <p class="submit-disclaimer">
  We'll provide you with a comprehensive entity analysis, formation roadmap, and transparent pricing (with flat-fee options where applicable). This consultation request does not create an attorney-client relationship.
        </p>
      </div>
    </form>
  </div>
</div>

<script>
// Smart Business Formation Analyzer
class BusinessFormationAnalyzer {
  constructor() {
    this.businessData = {};
    this.recommendations = [];
    this.selectedEntity = null;
    this.assessmentScore = 0;
  }
  
  analyzeInput(textarea) {
    const section = textarea.closest('.canvas-section');
    const value = textarea.value.trim();
    
    if (value.length > 10) {
      section.classList.add('active');
      this.businessData[section.querySelector('.canvas-title span:last-child').textContent.toLowerCase().replace(' ', '_')] = value;
      
      if (Object.keys(this.businessData).length >= 2) {
        this.showInsights();
        this.generateRecommendations();
      }
    } else {
      section.classList.remove('active');
    }
  }
  
  showInsights() {
    document.getElementById('aiInsights').style.display = 'block';
    
    // Analyze funding potential based on business concept
    const concept = this.businessData.business_concept || '';
    const market = this.businessData.target_market || '';
    
    let fundingPotential = 'Medium';
    let growthStage = 'Early';
    let recommendedEntity = 'LLC';
    
    // AI logic for funding potential
    if (concept.toLowerCase().includes('saas') || concept.toLowerCase().includes('software') || 
        concept.toLowerCase().includes('app') || concept.toLowerCase().includes('platform')) {
      fundingPotential = 'High';
      recommendedEntity = 'C-Corp';
    }
    
    if (concept.toLowerCase().includes('marketplace') || concept.toLowerCase().includes('network') ||
        market.toLowerCase().includes('enterprise') || market.toLowerCase().includes('b2b')) {
      fundingPotential = 'High';
      recommendedEntity = 'Delaware C-Corp';
    }
    
    if (concept.toLowerCase().includes('service') || concept.toLowerCase().includes('consulting')) {
      fundingPotential = 'Low';
      recommendedEntity = 'LLC';
    }
    
    // Update display
    document.getElementById('fundingPotential').textContent = fundingPotential;
    document.getElementById('growthStage').textContent = growthStage;
    document.getElementById('recommendedEntity').textContent = recommendedEntity;
    
    // Highlight recommended entity card
    this.highlightRecommended(recommendedEntity);
    
    // Store for backend
    document.getElementById('recommendedEntityHidden').value = recommendedEntity;
    document.getElementById('aiAnalysisHidden').value = JSON.stringify(this.businessData);
  }
  
  highlightRecommended(entity) {
    // Remove existing recommendations
    document.querySelectorAll('.entity-card').forEach(card => {
      card.classList.remove('recommended');
    });
    
    // Add recommendation to matching card
    const entityMap = {
      'LLC': 'LLC',
      'C-Corp': 'C-Corp',
      'Delaware C-Corp': 'Delaware-C'
    };
    
    const targetCard = document.querySelector(`[data-entity="${entityMap[entity]}"]`);
    if (targetCard) {
      targetCard.classList.add('recommended');
    }
  }
  
  generateRecommendations() {
    this.recommendations = [
      {
        priority: 'High',
        title: 'Entity Structure Optimization',
        description: 'Based on your business model, we recommend specific entity structures for maximum protection and growth potential.'
      }
    ];
    
    const concept = this.businessData.business_concept || '';
    
    if (concept.toLowerCase().includes('tech') || concept.toLowerCase().includes('software')) {
      this.recommendations.push({
        priority: 'Critical',
        title: 'Intellectual Property Protection',
        description: 'Tech businesses need immediate IP protection strategy including patents, trademarks, and trade secrets.'
      });
    }
    
    if (concept.toLowerCase().includes('marketplace') || concept.toLowerCase().includes('platform')) {
      this.recommendations.push({
        priority: 'High',
        title: 'Terms of Service & Privacy Policy',
        description: 'Platform businesses require comprehensive user agreements and data protection compliance.'
      });
    }
    
    const recsContainer = document.getElementById('recommendationsList');
    recsContainer.innerHTML = this.recommendations.map(rec => `
      <div class="rec-item">
        <div class="rec-priority">${rec.priority}</div>
        <div class="rec-title">${rec.title}</div>
        <div class="rec-desc">${rec.description}</div>
      </div>
    `).join('');
  }
  
  updateRecommendations() {
    const industry = document.querySelector('select[name="industry"]').value;
    const stage = document.querySelector('select[name="businessStage"]').value;
    const funding = document.querySelector('select[name="fundingPlans"]').value;
    
    let score = 20; // Base score
    
    // Industry-based scoring
    const industryScores = {
      'technology': 25,
      'fintech': 30,
      'healthcare': 28,
      'ecommerce': 22,
      'consulting': 18
    };
    score += industryScores[industry] || 15;
    
    // Stage-based scoring
    const stageScores = {
      'idea': 5,
      'mvp': 10,
      'prerevenue': 15,
      'earlyrevenue': 20,
      'growing': 25,
      'established': 30
    };
    score += stageScores[stage] || 10;
    
    // Funding-based scoring and recommendations
    if (funding === 'vc' || funding === 'angel') {
      score += 25;
      this.highlightRecommended('Delaware C-Corp');
    } else if (funding === 'bootstrap') {
      score += 10;
      this.highlightRecommended('LLC');
    }
    
    this.assessmentScore = Math.min(score, 100);
    document.getElementById('assessmentScoreHidden').value = this.assessmentScore;
  }
}

// Global functions
function activateSection(section) {
  section.querySelector('textarea').focus();
}

function selectEntity(entityType) {
  // Remove previous selections
  document.querySelectorAll('.entity-card').forEach(card => {
    card.style.borderColor = '#e2e8f0';
    card.style.boxShadow = 'none';
  });
  
  // Highlight selected
  const selectedCard = document.querySelector(`[data-entity="${entityType}"]`);
  selectedCard.style.borderColor = '#3b82f6';
  selectedCard.style.boxShadow = '0 0 20px rgba(59, 130, 246, 0.3)';
  
  analyzer.selectedEntity = entityType;
  document.getElementById('recommendedEntityHidden').value = entityType;
}

async function submitBusinessFormation(event) {
  event.preventDefault();
  
  const form = document.getElementById('businessFormationForm');
  const formData = new FormData(form);
  
  // Convert to object for JSON submission
  const data = {};
  for (let [key, value] of formData.entries()) {
    data[key] = value;
  }
  
  // Add analyzer data
  data.selectedEntity = analyzer.selectedEntity;
  data.businessAnalysis = analyzer.businessData;
  data.aiRecommendations = analyzer.recommendations;
  data.assessmentScore = analyzer.assessmentScore;
  data.timestamp = new Date().toISOString();
  
  // Submit to backend
  try {
    const button = document.querySelector('.submit-button');
    const originalText = button.textContent;
    button.textContent = 'Processing Your Analysis...';
    button.disabled = true;
    
    const response = await fetch('https://estate-intake-system.onrender.com/add-subscriber', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    });
    
    const result = await response.json();
    
    if (result.ok) {
      // Success - redirect to thank you page
      window.location.href = 'https://www.jacobscounsellaw.com/thank-you?type=business-formation';
    } else {
      throw new Error(result.error || 'Submission failed');
    }
  } catch (error) {
    console.error('Business formation submission error:', error);
    alert('There was an error submitting your information. Please try again or contact us directly.');
    
    const button = document.querySelector('.submit-button');
    button.textContent = 'Get My Business Formation Strategy';
    button.disabled = false;
  }
}

// Initialize analyzer
const analyzer = new BusinessFormationAnalyzer();

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
  // Any initialization code
});
</script>
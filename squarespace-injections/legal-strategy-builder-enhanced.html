<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Free Legal Strategy Builder | Find Your Legal Priorities | Jacobs Counsel</title>
<style>
  :root {
    --jc-orange: #ff4d00;
    --jc-ink: #0f172a;
    --bg: #ffffff;
    --ink: #0f172a;
    --ink2: #64748b;
    --line: #e2e8f0;
    --ok: #059669;
    --err: #dc2626;
    --warn: #d97706;
    --card: #ffffff;
    --muted: #f8fafc;
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
    --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: var(--bg);
    color: var(--ink);
    line-height: 1.6;
    font-size: 20px;
  }
  .strategy-wrap {
    max-width: 1000px;
    margin: 0 auto;
    background: var(--bg);
  }
  .jc-bar {
    height: 5px;
    background: linear-gradient(90deg, var(--jc-orange), var(--jc-ink));
  }
  /* Hero Section */
  .strategy-hero {
    background: linear-gradient(135deg, var(--muted) 0%, var(--bg) 100%);
    padding: 48px 20px 32px;
    text-align: center;
  }
  .hero-badge {
    display: inline-block;
    background: var(--jc-orange);
    color: white;
    padding: 5px 16px;
    border-radius: 50px;
    font-size: 16px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    margin-bottom: 10px;
  }
  .hero-headline {
    font-size: clamp(2.5rem, 5vw, 3.5rem);
    font-weight: 800;
    color: var(--ink);
    margin: 0 0 16px;
    letter-spacing: -0.02em;
    line-height: 1.05;
  }
  .hero-subhead {
    font-size: 28px;
    color: var(--jc-orange);
    font-weight: 600;
    margin: 0 0 12px;
  }
  .hero-desc {
    font-size: 20px;
    color: var(--ink2);
    max-width: 700px;
    margin: 0 auto 24px;
    line-height: 1.5;
  }
  /* What Box */
  .what-box {
    background: linear-gradient(135deg, rgba(255,77,0,0.04), rgba(255,77,0,0.01));
    border: 2px solid var(--jc-orange);
    border-radius: 12px;
    padding: 20px;
    margin: 0 20px 25px;
    position: relative;
  }
  .what-box h2 {
    font-size: 28px;
    font-weight: 700;
    margin: 0 0 12px;
    color: var(--ink);
    text-align: center;
  }
  .what-list {
    display: grid;
    gap: 10px;
  }
  .what-item {
    display: flex;
    align-items: start;
    gap: 10px;
  }
  .what-icon {
    color: var(--ok);
    font-size: 22px;
    margin-top: 2px;
    flex-shrink: 0;
  }
  .what-text {
    flex: 1;
    font-size: 18px;
    color: var(--ink);
    line-height: 1.5;
  }
  /* Value Props */
  .intro-section {
    padding: 32px 20px;
    background: var(--card);
    margin: 20px auto;
    max-width: 1000px;
  }
  .intro-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    margin: 0 0 24px;
  }
  .intro-card {
    text-align: center;
    padding: 24px;
    background: var(--muted);
    border-radius: 12px;
  }
  .intro-icon {
    font-size: 48px;
    margin-bottom: 12px;
    display: block;
  }
  .intro-card h4 {
    font-size: 22px;
    font-weight: 700;
    color: var(--ink);
    margin: 0 0 8px;
  }
  .intro-card p {
    color: var(--ink2);
    font-size: 17px;
    line-height: 1.5;
  }
  /* Assessment Container */
  .assessment-container {
    padding: 0 20px 32px;
    max-width: 900px;
    margin: 0 auto;
  }
  /* Progress Section */
  .progress-section {
    background: var(--muted);
    border-radius: 12px;
    padding: 24px;
    margin: 20px 0;
    box-shadow: var(--shadow-md);
  }
  .step-counter {
    font-size: 18px;
    font-weight: 700;
    color: var(--jc-orange);
    display: block;
    margin-bottom: 10px;
  }
  .progress-bar-container {
    width: 100%;
    height: 10px;
    background: var(--line);
    border-radius: 5px;
    overflow: hidden;
    margin: 0 0 10px;
  }
  .progress-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--jc-orange), #ff6d20);
    transition: width 0.3s ease;
    border-radius: 5px;
  }
  .progress-label {
    font-size: 16px;
    color: var(--ink2);
    font-weight: 500;
  }
  /* Question Section */
  .question-section {
    opacity: 1;
    transition: opacity 0.3s ease;
  }
  .question-section.transitioning {
    opacity: 0.7;
  }
  .question-card {
    background: var(--card);
    border-radius: 16px;
    padding: 32px 24px;
    margin: 20px 0;
    box-shadow: var(--shadow-lg);
    border: 3px solid var(--line);
  }
  .question-header {
    text-align: center;
    margin-bottom: 28px;
  }
  .question-badge {
    display: inline-block;
    background: var(--jc-orange);
    color: white;
    padding: 6px 18px;
    border-radius: 24px;
    font-size: 16px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 20px;
  }
  .question-title {
    font-size: 32px;
    font-weight: 800;
    color: var(--ink);
    margin-bottom: 12px;
    letter-spacing: -0.02em;
    line-height: 1.2;
  }
  .question-subtitle {
    font-size: 19px;
    color: var(--ink2);
    line-height: 1.5;
    max-width: 700px;
    margin: 0 auto;
  }
  /* Options Grid */
  .options-grid {
    display: grid;
    gap: 14px;
  }
  .option-card {
    display: flex;
    gap: 16px;
    padding: 20px;
    background: var(--muted);
    border: 3px solid var(--line);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.2s;
    align-items: flex-start;
  }
  .option-card:hover {
    background: var(--card);
    border-color: var(--jc-orange);
    transform: translateX(4px);
    box-shadow: var(--shadow-md);
  }
  .option-card.selected {
    background: linear-gradient(135deg, rgba(255, 77, 0, 0.08), rgba(255, 77, 0, 0.03));
    border-color: var(--jc-orange);
    box-shadow: var(--shadow-md);
  }
  .option-selector {
    width: 24px;
    height: 24px;
    border: 3px solid var(--line);
    border-radius: 50%;
    flex-shrink: 0;
    margin-top: 3px;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .option-selector.checkbox {
    border-radius: 4px;
  }
  .option-card:hover .option-selector {
    border-color: var(--jc-orange);
  }
  .option-card.selected .option-selector {
    background: var(--jc-orange);
    border-color: var(--jc-orange);
    color: white;
    font-size: 14px;
    font-weight: bold;
  }
  .option-card.selected .option-selector::after {
    content: '✓';
  }
  .option-content {
    flex: 1;
  }
  .option-title {
    font-size: 22px;
    font-weight: 700;
    color: var(--ink);
    margin-bottom: 6px;
    letter-spacing: -0.01em;
  }
  .option-description {
    color: var(--ink2);
    font-size: 17px;
    line-height: 1.5;
  }
  /* Navigation */
  .nav-section {
    display: flex;
    gap: 12px;
    justify-content: space-between;
    margin-top: 24px;
  }
  .btn {
    padding: 16px 32px;
    border-radius: 10px;
    font-weight: 700;
    transition: all .3s;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 19px;
    cursor: pointer;
    border: none;
    font-family: inherit;
    gap: 6px;
    text-decoration: none;
  }
  .btn-primary {
    background: var(--jc-orange);
    color: white;
    box-shadow: var(--shadow-lg);
  }
  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-xl);
  }
  .btn-secondary {
    background: var(--muted);
    color: var(--ink);
    border: 2px solid var(--line);
  }
  .btn-secondary:hover {
    background: var(--line);
    border-color: var(--ink2);
  }
  .btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none !important;
  }
  .btn-large {
    padding: 20px 40px;
    font-size: 21px;
  }
  /* Email Gate */
  .email-gate {
    background: var(--card);
    border-radius: 16px;
    padding: 32px 24px;
    margin: 20px auto;
    text-align: center;
    box-shadow: var(--shadow-xl);
    border: 3px solid var(--jc-orange);
    max-width: 600px;
  }
  .email-gate h3 {
    font-size: 30px;
    font-weight: 700;
    color: var(--ink);
    margin: 0 0 12px;
    letter-spacing: -0.02em;
  }
  .email-gate p {
    font-size: 19px;
    color: var(--ink2);
    margin: 0 0 20px;
    max-width: 450px;
    margin-left: auto;
    margin-right: auto;
  }
  .email-input {
    width: 100%;
    max-width: 400px;
    padding: 16px 20px;
    border: 3px solid var(--line);
    border-radius: 8px;
    font-size: 19px;
    margin: 0 0 20px;
    font-family: inherit;
    transition: all 0.3s;
  }
  .email-input:focus {
    outline: none;
    border-color: var(--jc-orange);
    box-shadow: 0 0 0 3px rgba(255, 77, 0, 0.1);
  }
  /* Results Section */
  .results-container {
    background: var(--muted);
    border-radius: 20px;
    padding: 32px 24px;
    margin: 20px 0;
  }
  .results-header {
    text-align: center;
    margin-bottom: 28px;
  }
  .results-icon {
    width: 72px;
    height: 72px;
    background: var(--jc-orange);
    border-radius: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 16px;
    font-size: 36px;
    color: white;
    box-shadow: var(--shadow-xl);
  }
  .results-title {
    font-size: 36px;
    font-weight: 800;
    margin: 0 0 12px;
    color: var(--ink);
    letter-spacing: -0.02em;
  }
  .results-subtitle {
    font-size: 19px;
    color: var(--ink2);
    max-width: 700px;
    margin: 0 auto;
    line-height: 1.5;
  }
  /* Score Display */
  .score-card {
    background: var(--bg);
    border-radius: 16px;
    padding: 32px;
    margin: 24px 0;
    text-align: center;
    box-shadow: var(--shadow-lg);
    border: 3px solid var(--line);
  }
  .score-value {
    font-size: 72px;
    font-weight: 800;
    color: var(--jc-orange);
    margin-bottom: 8px;
    line-height: 1;
  }
  .score-label {
    font-size: 18px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--ink2);
    margin-bottom: 12px;
  }
  .score-description {
    color: var(--ink);
    font-size: 22px;
    font-weight: 500;
    line-height: 1.4;
  }
  /* Recommendations */
  .recommendations-grid {
    display: grid;
    gap: 16px;
    margin: 24px 0;
  }
  .recommendation-card {
    background: var(--bg);
    border-radius: 12px;
    padding: 20px;
    border-left: 5px solid;
    box-shadow: var(--shadow-md);
    transition: all 0.3s;
  }
  .recommendation-card:hover {
    transform: translateX(4px);
    box-shadow: var(--shadow-lg);
  }
  .recommendation-card.priority-high { border-left-color: var(--err); }
  .recommendation-card.priority-medium { border-left-color: var(--warn); }
  .recommendation-card.priority-low { border-left-color: var(--ok); }
  .recommendation-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 8px;
  }
  .recommendation-icon {
    width: 36px;
    height: 36px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    flex-shrink: 0;
  }
  .recommendation-card.priority-high .recommendation-icon {
    background: rgba(220, 38, 38, 0.1);
    color: var(--err);
  }
  .recommendation-card.priority-medium .recommendation-icon {
    background: rgba(217, 119, 6, 0.1);
    color: var(--warn);
  }
  .recommendation-card.priority-low .recommendation-icon {
    background: rgba(5, 150, 105, 0.1);
    color: var(--ok);
  }
  .recommendation-title {
    font-size: 22px;
    font-weight: 700;
    color: var(--ink);
    letter-spacing: -0.01em;
  }
  .recommendation-description {
    color: var(--ink2);
    line-height: 1.5;
    font-size: 17px;
  }
  /* CTA Section */
  .cta-section {
    background: linear-gradient(135deg, var(--jc-ink), var(--jc-orange));
    border-radius: 16px;
    padding: 32px 24px;
    text-align: center;
    margin: 28px 0;
    color: white;
  }
  .cta-section h3 {
    color: white;
    margin: 0 0 12px;
    font-size: 32px;
    font-weight: 800;
    letter-spacing: -0.02em;
  }
  .cta-section p {
    margin: 0 0 24px;
    font-size: 20px;
    opacity: 0.95;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    line-height: 1.5;
  }
  .cta-buttons {
    display: flex;
    gap: 16px;
    justify-content: center;
    flex-wrap: wrap;
  }
  .btn-cta-primary,
  .btn-cta-secondary {
    padding: 16px 32px;
    border-radius: 10px;
    font-size: 19px;
    font-weight: 700;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s;
    border: none;
  }
  .btn-cta-primary {
    background: white;
    color: var(--jc-ink);
    box-shadow: var(--shadow-xl);
  }
  .btn-cta-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  }
  .btn-cta-secondary {
    background: transparent;
    color: white;
    border: 3px solid rgba(255, 255, 255, 0.3);
  }
  .btn-cta-secondary:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: white;
  }

  /* AI Enhancement: Subtle real-time score indicator */
  .live-score-indicator {
    position: fixed;
    top: 20px;
    right: 20px;
    background: var(--card);
    border: 2px solid var(--jc-orange);
    border-radius: 50px;
    padding: 8px 16px;
    font-size: 14px;
    font-weight: 700;
    color: var(--jc-orange);
    box-shadow: var(--shadow-lg);
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 1000;
  }
  .live-score-indicator.visible {
    opacity: 1;
  }

  @media(max-width: 768px) {
    body { font-size: 16px; }
    .hero-headline { font-size: 2rem; }
    .hero-subhead { font-size: 20px; }
    .hero-desc { font-size: 16px; }
   
    .question-title { font-size: 24px; }
    .question-subtitle { font-size: 16px; }
    .option-title { font-size: 18px; }
    .option-description { font-size: 15px; }
   
    .nav-section { flex-direction: column; gap: 10px; }
    .btn { width: 100%; padding: 14px 24px; font-size: 16px; }
   
    .results-title { font-size: 28px; }
    .score-value { font-size: 48px; }
    .score-description { font-size: 17px; }
   
    .recommendation-title { font-size: 18px; }
    .recommendation-description { font-size: 15px; }
   
    .cta-section h3 { font-size: 24px; }
    .cta-section p { font-size: 16px; }
    .cta-buttons { flex-direction: column; }

    .live-score-indicator {
      position: relative;
      top: auto;
      right: auto;
      margin: 10px auto;
      display: block;
      width: fit-content;
    }
}
</style>
</head>
<body>
<div class="strategy-wrap" id="strategy-app">
  <div class="jc-bar"></div>
  
  <!-- AI Enhancement: Subtle live score indicator -->
  <div class="live-score-indicator" id="liveScore">Score: 0</div>
 
  <!-- Hero Section -->
  <section class="strategy-hero">
    <div class="hero-badge">Free Legal Assessment</div>
    <h1 class="hero-headline">Don't Guess What Legal Help You Need</h1>
    <p class="hero-subhead">Get Your Custom Legal Roadmap in 5 Minutes</p>
  </section>
  <div class="what-box">
    <h2>This Free Assessment Will Tell You:</h2>
    <div class="what-list">
      <div class="what-item">
        <span class="what-icon">✓</span>
        <span class="what-text">Your biggest legal vulnerabilities right now</span>
      </div>
      <div class="what-item">
        <span class="what-icon">✓</span>
        <span class="what-text">Which legal protections you need first (and which can wait)</span>
      </div>
      <div class="what-item">
        <span class="what-icon">✓</span>
        <span class="what-text">Your Legal Foundation Score™ from 0-100</span>
      </div>
      <div class="what-item">
        <span class="what-icon">✓</span>
        <span class="what-text">A prioritized roadmap specific to your role and goals</span>
      </div>
      <div class="what-item">
        <span class="what-icon">✓</span>
        <span class="what-text">Next steps to protect your affairs</span>
      </div>
    </div>
  </div>
   
    <div style="text-align:center">
      <button class="btn btn-primary btn-large" onclick="startAssessment()">Start My Free Assessment →</button>
    </div>
  <!-- Assessment Container -->
  <div class="assessment-container" id="assessment-section" style="display:none">
    <!-- Progress Section -->
    <div class="progress-section">
      <span class="step-counter" id="step-counter">Question 1 of 8</span>
      <div class="progress-bar-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>
      <div class="progress-label" id="progress-label">Getting Started • 5 minutes remaining</div>
    </div>
    <!-- Questions will be dynamically inserted here -->
  </div>
  <!-- Email Gate -->
  <div class="email-gate" id="email-gate" style="display:none">
    <h3>Get Your Legal Roadmap</h3>
    <p>Enter your email to see your score and receive your personalized strategy.</p>
    <input type="email" class="email-input" id="email-input" placeholder="your@email.com" required>
    <button class="btn btn-primary btn-large" onclick="submitEmail()">See My Results →</button>
  </div>
</div>
<script>
const BACKEND_BASE = 'https://estate-intake-system.onrender.com';

// Your original assessment questions - preserved exactly
const assessmentQuestions = [
  {
    badge: "Strategic Foundation",
    title: "What best describes your primary role?",
    subtitle: "This helps us understand your unique legal needs and tailor our recommendations to your specific industry and situation.",
    type: "single",
    options: [
      { value: "founder", icon: "🚀", title: "Founder/Entrepreneur", description: "Building a company, leading a startup, or launching new ventures" },
      { value: "athlete", icon: "🏆", title: "Professional/Student Athlete", description: "Competing professionally, managing NIL deals, or building an athletic brand" },
      { value: "creator", icon: "🎨", title: "Content Creator/Influencer", description: "Creating content, building audience, managing brand partnerships" },
      { value: "professional", icon: "💼", title: "Working Professional", description: "Employed professional focused on personal wealth and asset protection" },
      { value: "business-owner", icon: "🏪", title: "Business Owner", description: "Running an established business, agency, or service company" },
      { value: "investor", icon: "🏢", title: "Real Estate/Investor", description: "Managing investments, real estate portfolio, or family wealth" }
    ]
  },
  {
    badge: "Current Stage",
    title: "Where are you in your journey?",
    subtitle: "Understanding your current stage helps us prioritize immediate needs versus long-term planning.",
    type: "single",
    options: [
      { value: "idea", icon: "💡", title: "Planning/Early Stage", description: "Developing concepts, just starting out, or in early stages" },
      { value: "active", icon: "⚡", title: "Active/Building", description: "Actively working, creating, or establishing operations" },
      { value: "growth", icon: "📈", title: "Growth/Scaling", description: "Generating consistent income and looking to expand" },
      { value: "established", icon: "🏛️", title: "Established/Optimizing", description: "Well-established with focus on protection and optimization" }
    ]
  },
  {
    badge: "Legal Structure",
    title: "How are your activities currently structured?",
    subtitle: "Your legal entity structure affects everything from taxes to liability protection.",
    type: "single",
    options: [
      { value: "none", icon: "👤", title: "No Formal Structure", description: "Operating under personal name without a business entity" },
      { value: "llc", icon: "🏢", title: "LLC", description: "Limited Liability Company for business or asset protection" },
      { value: "corp", icon: "🏛️", title: "Corporation", description: "C-Corp or S-Corp structure" },
      { value: "multiple", icon: "🔄", title: "Multiple Entities", description: "Complex structure with multiple companies or trusts" },
      { value: "unsure", icon: "❓", title: "Unsure/Other", description: "Not certain about current structure or partnership arrangement" }
    ]
  },
  {
    badge: "Intellectual Property",
    title: "How protected are your creative works and brand?",
    subtitle: "Your ideas, content, and brand identity are valuable assets that need proper protection.",
    type: "single",
    options: [
      { value: "none", icon: "🔓", title: "No Protection", description: "Haven't filed any IP protections or registrations" },
      { value: "basic", icon: "🔒", title: "Basic Protection", description: "Some copyrights or basic trademark filings" },
      { value: "moderate", icon: "🛡️", title: "Moderate Protection", description: "Key assets protected with formal registrations" },
      { value: "comprehensive", icon: "⚔️", title: "Comprehensive Strategy", description: "Full IP portfolio with active management and enforcement" }
    ]
  },
  {
    badge: "Contract Management",
    title: "How do you handle agreements and deals?",
    subtitle: "Proper documentation protects your interests in every business relationship.",
    type: "single",
    options: [
      { value: "informal", icon: "🤝", title: "Informal/Verbal", description: "Mostly handshake deals or email confirmations" },
      { value: "templates", icon: "📄", title: "Basic Templates", description: "Using online templates or simple written agreements" },
      { value: "standard", icon: "📋", title: "Standard Contracts", description: "Consistent use of proper legal documents" },
      { value: "professional", icon: "⚖️", title: "Attorney-Reviewed", description: "All significant agreements reviewed by legal counsel" }
    ]
  },
  {
    badge: "Financial Position",
    title: "What's your current revenue or asset level?",
    subtitle: "Your financial position determines the complexity of legal strategies needed.",
    type: "single",
    options: [
      { value: "starting", icon: "🌱", title: "Getting Started", description: "Under $50K in annual revenue or assets" },
      { value: "moderate", icon: "🌿", title: "Building Momentum", description: "$50K - $250K annually" },
      { value: "strong", icon: "🌳", title: "Strong Position", description: "$250K - $1M annually" },
      { value: "substantial", icon: "🏔️", title: "Substantial Wealth", description: "Over $1M in revenue or assets" }
    ]
  },
  {
    badge: "Risk Concerns",
    title: "What keeps you up at night legally?",
    subtitle: "Select all areas where you feel vulnerable or concerned about potential legal issues.",
    type: "multiple",
    options: [
      { value: "liability", icon: "🛡️", title: "Personal Asset Protection", description: "Protecting wealth from lawsuits or claims" },
      { value: "ip", icon: "💡", title: "IP Theft", description: "Someone stealing ideas or content" },
      { value: "contracts", icon: "📝", title: "Bad Deals", description: "Getting locked into unfavorable agreements" },
      { value: "compliance", icon: "⚖️", title: "Legal Compliance", description: "Breaking rules without knowing it" },
      { value: "tax", icon: "💰", title: "Tax Issues", description: "Paying too much or missing obligations" },
      { value: "estate", icon: "🏛️", title: "Legacy Planning", description: "What happens to assets if something happens to you" }
    ]
  },
  {
    badge: "Strategic Goals",
    title: "What's your primary objective for the next 12 months?",
    subtitle: "Aligning legal strategy with your business goals ensures maximum impact.",
    type: "single",
    options: [
      { value: "protect", icon: "🔒", title: "Protect & Secure", description: "Lock down foundations and minimize risk" },
      { value: "scale", icon: "🚀", title: "Scale & Grow", description: "Expand operations and increase revenue" },
      { value: "fundraise", icon: "💎", title: "Raise Capital", description: "Prepare for investors or major funding" },
      { value: "optimize", icon: "⚡", title: "Optimize & Refine", description: "Improve efficiency and reduce costs" },
      { value: "exit", icon: "🎯", title: "Plan Exit/Transition", description: "Prepare for sale, succession, or major change" }
    ]
  }
];

let currentQuestion = 0;
let answers = {};
let userEmail = '';

function startAssessment() {
  document.getElementById('assessment-section').style.display = 'block';
 
  // Hide all intro content more aggressively
  const heroSection = document.querySelector('.strategy-hero');
  const whatBox = document.querySelector('.what-box');
  const buttonDiv = whatBox.nextElementSibling; // The div right after whatBox
 
  if (heroSection) heroSection.style.display = 'none';
  if (whatBox) whatBox.style.display = 'none';
  if (buttonDiv) buttonDiv.style.display = 'none';
 
  // Also hide any remaining button elements
  const allButtons = document.querySelectorAll('button');
  allButtons.forEach(btn => {
    if (btn.textContent.includes('Start My Free Assessment')) {
      btn.parentElement.style.display = 'none';
    }
  });

  // Show live score indicator
  document.getElementById('liveScore').classList.add('visible');
 
  renderQuestion(0);
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function renderQuestion(index) {
  const question = assessmentQuestions[index];
  const container = document.getElementById('assessment-section');
 
  document.getElementById('step-counter').textContent = `Question ${index + 1} of 8`;
  document.getElementById('progress-bar').style.width = `${((index + 1) / 8) * 100}%`;
 
  const timeRemaining = Math.max(1, 5 - Math.floor(index * 0.6));
  const progressLabels = [
    "Getting Started",
    "Building Your Profile",
    "Understanding Your Structure",
    "Assessing Protection",
    "Evaluating Processes",
    "Financial Analysis",
    "Risk Assessment",
    "Final Step"
  ];
  document.getElementById('progress-label').textContent = `${progressLabels[index]} • ${timeRemaining} minutes remaining`;

  const questionHTML = `
    <div class="question-section active" data-question="${index + 1}">
      <div class="question-card">
        <div class="question-header">
          <div class="question-badge">${question.badge}</div>
          <h2 class="question-title">${question.title}</h2>
          <p class="question-subtitle">${question.subtitle}</p>
        </div>
        <div class="options-grid">
          ${question.options.map(opt => `
            <div class="option-card" data-value="${opt.value}" onclick="selectOption(this, ${question.type === 'multiple'})">
              <div class="option-selector ${question.type === 'multiple' ? 'checkbox' : ''}"></div>
              <div class="option-content">
                <div class="option-title">${opt.icon} ${opt.title}</div>
                <div class="option-description">${opt.description}</div>
              </div>
            </div>
          `).join('')}
        </div>
      </div>
      <div class="nav-section">
        <button class="btn btn-secondary" onclick="previousQuestion()" ${index === 0 ? 'style="visibility:hidden"' : ''}>← Back</button>
        <button class="btn btn-primary" onclick="nextQuestion()" ${question.type === 'single' ? 'disabled' : ''}>${index === 7 ? 'Get My Roadmap →' : 'Continue →'}</button>
      </div>
    </div>
  `;

  const existingQuestion = container.querySelector('.question-section');
  if (existingQuestion) {
    existingQuestion.remove();
  }
  container.insertAdjacentHTML('beforeend', questionHTML);
}

function selectOption(element, isMultiple) {
  const questionCard = element.closest('.question-card');
  const questionSection = element.closest('.question-section');
  const questionIndex = parseInt(questionSection.dataset.question) - 1;
 
  if (isMultiple) {
    element.classList.toggle('selected');
  } else {
    questionCard.querySelectorAll('.option-card').forEach(opt => opt.classList.remove('selected'));
    element.classList.add('selected');
  }

  if (isMultiple) {
    const selected = Array.from(questionCard.querySelectorAll('.option-card.selected'))
      .map(opt => opt.dataset.value);
    answers[`q${questionIndex + 1}`] = selected;
  } else {
    answers[`q${questionIndex + 1}`] = element.dataset.value;
  }

  // Fix: Use more specific selector within the current question section
  const continueBtn = questionSection.querySelector('.nav-section .btn.btn-primary');
  if (continueBtn) {
    if (isMultiple) {
      continueBtn.disabled = questionCard.querySelectorAll('.option-card.selected').length === 0;
    } else {
      continueBtn.disabled = false;
    }
  }

  // AI Enhancement: Update live score
  updateLiveScore();
}

// AI Enhancement: Real-time score calculation
function updateLiveScore() {
  const currentScore = calculateScore();
  const liveScoreElement = document.getElementById('liveScore');
  liveScoreElement.textContent = `Score: ${currentScore}`;
}

function nextQuestion() {
  if (currentQuestion < 7) {
    currentQuestion++;
    renderQuestion(currentQuestion);
  } else {
    showEmailGate();
  }
}

function previousQuestion() {
  if (currentQuestion > 0) {
    currentQuestion--;
    renderQuestion(currentQuestion);
  }
}

function showEmailGate() {
  document.getElementById('assessment-section').style.display = 'none';
  document.getElementById('email-gate').style.display = 'block';
  document.getElementById('liveScore').classList.remove('visible');
  window.scrollTo({ top: 0, behavior: 'smooth' });
 
  if (typeof gtag !== 'undefined') {
    gtag('event', 'assessment_completed', {
      event_category: 'Legal Strategy Builder',
      event_label: 'Assessment Completed'
    });
  }
}

async function submitEmail() {
  const emailInput = document.getElementById('email-input');
  const email = emailInput.value.trim();
 
  if (!email || !email.includes('@')) {
    alert('Please enter a valid email address');
    return;
  }
 
  userEmail = email;
  const score = calculateScore(); // Calculate score here for submission
 
  try {
    const submissionData = {
      email: email,
      firstName: email.split('@')[0],
      submissionType: 'legal-strategy-builder',
      source: 'legal-strategy-builder',
      answers: answers,
      q1: answers.q1,
      q2: answers.q2,
      q3: answers.q3,
      q4: answers.q4,
      q5: answers.q5,
      q6: answers.q6,
      q7: answers.q7,
      q8: answers.q8,
      assessmentScore: score, // Add this line
      submissionId: `strategy-${Date.now()}`,
      timestamp: new Date().toISOString()
    };

    console.log('Submitting strategy builder data:', submissionData);
    const response = await fetch(`${BACKEND_BASE}/legal-strategy-builder`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(submissionData)
    });

    if (response.ok) {
      console.log('✅ Successfully submitted to backend');
    } else {
      console.error('❌ Backend submission failed:', await response.text());
    }
  } catch (error) {
    console.error('❌ Backend submission error:', error);
  }
 
  if (typeof gtag !== 'undefined') {
    gtag('event', 'email_submitted', {
      event_category: 'Legal Strategy Builder',
      event_label: 'Email Submitted'
    });
  }
 
  saveAssessmentData();
  showResults();
}

function calculateScore() {
  let score = 0;
  const weights = {
    structure: { none: 0, unsure: 5, llc: 15, corp: 20, multiple: 25 },
    ip: { none: 0, basic: 10, moderate: 20, comprehensive: 30 },
    contracts: { informal: 0, templates: 8, standard: 15, professional: 25 },
    revenue: { starting: 5, moderate: 10, strong: 15, substantial: 20 }
  };
 
  score += weights.structure[answers.q3] || 0;
  score += weights.ip[answers.q4] || 0;
  score += weights.contracts[answers.q5] || 0;
  score += weights.revenue[answers.q6] || 0;
 
  if (answers.q7) score += Math.min(answers.q7.length * 3, 15);
 
  return Math.min(100, Math.round(score * 1.1));
}

function generateRecommendations() {
  const recommendations = [];
  const role = answers.q1;
  const stage = answers.q2;
  const structure = answers.q3;
  const ip = answers.q4;
  const contracts = answers.q5;
  const risks = answers.q7 || [];
  const goal = answers.q8;

  if (structure === 'none' || structure === 'unsure') {
    recommendations.push({
      priority: 'high',
      icon: '🏢',
      title: 'Business Entity Formation',
      description: 'Establish the right legal entity (LLC, Corporation) to protect personal assets and optimize taxes for your specific situation.'
    });
  }

  if ((role === 'creator' || role === 'athlete' || role === 'founder') && (ip === 'none' || ip === 'basic')) {
    recommendations.push({
      priority: 'high',
      icon: '™️',
      title: 'Brand & IP Protection Strategy',
      description: 'Secure trademarks, copyrights, and establish ownership of your creative works and brand identity to prevent theft and maximize value.'
    });
  }

  if (contracts === 'informal' || contracts === 'templates') {
    recommendations.push({
      priority: 'medium',
      icon: '📝',
      title: 'Professional Agreement System',
      description: 'Develop attorney-reviewed contracts tailored to your specific business needs and industry to protect your interests in every deal.'
    });
  }

  if (risks.includes('liability')) {
    recommendations.push({
      priority: 'high',
      icon: '🛡️',
      title: 'Asset Protection Planning',
      description: 'Implement advanced strategies to shield personal wealth from potential lawsuits and claims while maintaining operational flexibility.'
    });
  }

  if (risks.includes('estate')) {
    recommendations.push({
      priority: 'medium',
      icon: '🏛️',
      title: 'Estate & Succession Planning',
      description: 'Create comprehensive plans for wealth transfer and business continuity to protect your family and legacy.'
    });
  }

  if (goal === 'fundraise') {
    recommendations.push({
      priority: 'high',
      icon: '💎',
      title: 'Investment Readiness Package',
      description: 'Prepare all legal documentation and structures required for fundraising, including clean cap tables and investor-friendly terms.'
    });
  }

  if (goal === 'scale' && stage !== 'established') {
    recommendations.push({
      priority: 'medium',
      icon: '📈',
      title: 'Scalable Legal Infrastructure',
      description: 'Build systems and processes that can grow with your business without constant legal intervention or restructuring.'
    });
  }

  if (risks.includes('tax')) {
    recommendations.push({
      priority: 'medium',
      icon: '💰',
      title: 'Tax Structure Optimization',
      description: 'Review and optimize your legal structure for maximum tax efficiency and compliance while supporting your growth objectives.'
    });
  }

  if (risks.includes('compliance') || recommendations.length < 4) {
    recommendations.push({
      priority: 'low',
      icon: '✅',
      title: 'Legal Compliance Audit',
      description: 'Comprehensive review to ensure all legal requirements are met for your industry and identify potential compliance gaps.'
    });
  }

  return recommendations.slice(0, 5);
}

function generateSmartNextStep(answers, score) {
  let stepTitle = 'Complete Your Legal Assessment';
  let stepDescription = 'Get personalized legal recommendations';
  let stepUrl = '/business-protection';
  let stepUrgency = 'Typical turnaround: 2-3 weeks';

  if (answers.q3 === 'none' || answers.q3 === 'unsure') {
    if (answers.q8 === 'fundraise') {
      stepTitle = 'Get VC-Ready Legal Structure';
      stepDescription = 'Set up your Delaware C-Corp for fundraising';
      stepUrl = '/business-protection?focus=vc';
      stepUrgency = '🚨 Urgent: 87% of VC rejections happen during legal review';
    } else {
      stepTitle = 'Start Your Business Formation';
      stepDescription = 'Get your LLC or Corporation set up to protect your personal assets';
      stepUrl = '/business-protection';
      stepUrgency = score >= 70 ? '🔥 Priority setup available' : 'Typical turnaround: 2-3 weeks';
    }
  } else if ((answers.q4 === 'none' || answers.q4 === 'basic') && (answers.q3 !== 'none' && answers.q3 !== 'unsure')) {
    if (answers.q1 === 'athlete') {
      stepTitle = 'Protect Your Athletic Brand';
      stepDescription = 'Trademark your name and secure your NIL value';
      stepUrl = '/brand-protection?focus=athlete';
      stepUrgency = '⚡ Athletes: Protect your brand before someone else claims it';
    } else if (answers.q1 === 'creator') {
      stepTitle = 'Secure Your Creator Brand';
      stepDescription = 'Lock down trademark protection for your content brand';
      stepUrl = '/brand-protection?focus=creator';
      stepUrgency = '🎨 Creators: Your brand IS your business - protect it legally';
    } else if (answers.q1 === 'founder') {
      stepTitle = 'Protect Your Startup Brand';
      stepDescription = 'Secure trademark protection for your company and products';
      stepUrl = '/brand-protection?focus=startup';
      stepUrgency = '🚀 Startups: Lock down your brand before competitors copy you';
    } else {
      stepTitle = 'Protect Your Brand Identity';
      stepDescription = 'Secure trademark protection before competitors steal your identity';
      stepUrl = '/brand-protection';
      stepUrgency = score >= 70 ? '🔥 Priority trademark filing' : 'Standard processing: 4-6 weeks';
    }
  } else if (answers.q7?.includes('estate') || answers.q6 === 'substantial') {
    if (answers.q1 === 'athlete') {
      stepTitle = 'Plan Your Athletic Wealth Strategy';
      stepDescription = 'Protect your NIL earnings and athletic career wealth';
      stepUrl = '/wealth-protection?focus=athlete';
      stepUrgency = '🏆 Athletes: Plan for career transitions and wealth protection';
    } else {
      stepTitle = 'Plan Your Wealth Protection Strategy';
      stepDescription = 'Create a comprehensive estate plan to protect your assets and family';
      stepUrl = '/wealth-protection';
      stepUrgency = answers.q6 === 'substantial' ? '💰 High net worth: Advanced strategies available' : '🛡️ Essential planning for asset protection';
    }
  } else if (answers.q2 === 'established' && (answers.q8 === 'scale' || answers.q8 === 'exit')) {
    stepTitle = 'Get Ongoing Legal Support';
    stepDescription = 'Access comprehensive legal counsel for your established business';
    stepUrl = '/outside-counsel';
    stepUrgency = '🏢 Established businesses: Proactive legal prevents expensive problems';
  } else {
    stepTitle = 'Optimize Your Legal Strategy';
    stepDescription = 'Get ongoing legal counsel to maximize your protection and growth';
    stepUrl = '/outside-counsel';
    stepUrgency = '⚡ Strong foundation: Time to optimize and scale';
  }

  return `
    <div class="smart-next-step" style="background: linear-gradient(135deg, #f0fdf4, #dcfce7); padding: 28px 24px; border-radius: 16px; margin: 28px 0; border: 3px solid #22c55e; text-align: center;">
      <h3 style="margin: 0 0 16px; font-size: 28px; color: #166534; font-weight: 800;">Your Next Step</h3>
      <h4 style="margin: 0 0 10px; font-size: 24px; color: #15803d; font-weight: 700;">${stepTitle}</h4>
      <p style="margin: 0 0 8px; font-size: 18px; color: #166534; line-height: 1.5;">${stepDescription}</p>
      <p class="urgency" style="margin: 0 0 20px; font-size: 16px; color: #15803d; font-weight: 600;">${stepUrgency}</p>
     
      <a href="${stepUrl}?from=assessment&role=${answers.q1}"
         class="btn-next"
         style="background: linear-gradient(135deg, #22c55e, #16a34a);
                color: white;
                padding: 16px 32px;
                border-radius: 10px;
                text-decoration: none;
                font-weight: 700;
                font-size: 19px;
                display: inline-block;
                box-shadow: 0 6px 20px rgba(34, 197, 94, 0.3);
                margin: 0 0 16px;">
        Complete Your Intake Now →
      </a>
     
      <div style="margin: 12px 0 0;">
        <a href="https://app.usemotion.com/meet/drew-jacobs-jcllc/8xx9grm"
           class="alt-link"
           style="color: #166534; text-decoration: none; font-size: 17px; font-weight: 500;">
          Or book a strategy call first →
        </a>
      </div>
    </div>
  `;
}

function saveAssessmentData() {
  const assessmentData = {
    email: userEmail,
    answers: answers,
    score: calculateScore(),
    timestamp: new Date().toISOString(),
    role: answers.q1,
    stage: answers.q2,
    structure: answers.q3,
    ip: answers.q4
  };
 
  localStorage.setItem('legal-assessment-data', JSON.stringify(assessmentData));
  console.log('💾 Saved assessment data:', assessmentData);
}

function showResults() {
  const score = calculateScore();
  const recommendations = generateRecommendations();
  const role = answers.q1;
 
  const roleData = {
    founder: { icon: '🚀', title: 'Founder Legal Roadmap' },
    athlete: { icon: '🏆', title: 'Athlete Protection Strategy' },
    creator: { icon: '🎨', title: 'Creator Legal Framework' },
    professional: { icon: '💼', title: 'Professional Asset Plan' },
    'business-owner': { icon: '🏪', title: 'Business Legal Strategy' },
    investor: { icon: '🏢', title: 'Investment Protection Plan' }
  };

  let scoreDescription = '';
  if (score >= 80) scoreDescription = 'Excellent foundation with minor optimization opportunities';
  else if (score >= 60) scoreDescription = 'Good foundation with key areas for improvement';
  else if (score >= 40) scoreDescription = 'Developing foundation with important gaps to address';
  else scoreDescription = 'Early stage - significant opportunities to strengthen legal position';

  const resultsHTML = `
    <div class="results-container">
      <div class="results-header">
        <div class="results-icon">${roleData[role]?.icon || '📊'}</div>
        <h2 class="results-title">${roleData[role]?.title || 'Your Legal Roadmap'}</h2>
        <p class="results-subtitle">Your personalized legal roadmap based on your unique situation and strategic goals</p>
      </div>
     
      <div class="score-card">
        <div class="score-label">Legal Foundation Score</div>
        <div class="score-value">${score}</div>
        <div class="score-description">${scoreDescription}</div>
      </div>

      <h3 style="margin: 20px 0 16px; font-size: 28px; text-align: center; font-weight: 800; color: var(--ink); letter-spacing: -0.025em">Your Priority Action Plan</h3>
      <div class="recommendations-grid">
        ${recommendations.map(rec => `
          <div class="recommendation-card priority-${rec.priority}">
            <div class="recommendation-header">
              <div class="recommendation-icon">${rec.icon}</div>
              <div class="recommendation-title">${rec.title}</div>
            </div>
            <div class="recommendation-description">${rec.description}</div>
          </div>
        `).join('')}
      </div>

      ${generateSmartNextStep(answers, score)}

      <div class="cta-section">
        <h3>Ready to Secure Your Legal Foundation?</h3>
        <p>Take action on your personalized recommendations with expert legal guidance.</p>
        <div class="cta-buttons">
          <a href="https://app.usemotion.com/meet/drew-jacobs-jcllc/8xx9grm"
             class="btn-cta-primary">
            📅 Book Free Consultation
          </a>
          <a href="mailto:drew@jacobscounsellaw.com"
             class="btn-cta-secondary">
            📧 Email Drew Directly
          </a>
        </div>
      </div>
    </div>
  `;

  document.getElementById('email-gate').style.display = 'none';
  document.getElementById('assessment-section').innerHTML = resultsHTML;
  document.getElementById('assessment-section').style.display = 'block';
 
  if (typeof gtag !== 'undefined') {
    gtag('event', 'results_viewed', {
      event_category: 'Legal Strategy Builder',
      event_label: 'Results Viewed',
      value: score
    });
  }
 
  window.scrollTo({ top: 0, behavior: 'smooth' });
}
</script>
</body>
</html>